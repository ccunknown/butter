{"version":3,"sources":["../src/clock_ctrl.js"],"names":["PanelCtrl","moment","panelDefaults","title","butter","butterType","label","initial","method","url","headers","onstring","body","on","off","ClockCtrl","$scope","$injector","_","defaultsDeep","panel","headtxt","butterstate","edmShowButter","edmShowButterOn","edmShowButterOff","edmShowButterInitial","edmRequestIndex","init_butterstate","initialAllButterState","events","onInitEditMode","bind","updateButter","init_edmShowButter","addEditorTab","len","length","i","index","console","log","tea","$timeout","splice","push","bindex","mode","data","headerkey","headervalue","undefined","JSON","stringify","initialButterState","arr","checkarr","setbutterfunc","sendRequest","then","catch","error","cindex","rurl","rmethod","rheaders","rbody","fetch","response","json","templateUrl"],"mappings":"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","file":"clock_ctrl.js","sourcesContent":["import {PanelCtrl} from 'app/plugins/sdk';\nimport moment from 'moment';\nimport './css/toggle-checkbox.css!';\n\nvar panelDefaults = {\n  title: 'Panel Title',\n  butter:[\n    {\n      butterType: 'on/off button',\n      label: 'Label 0',\n      initial:[\n        {\n          method: 'GET',\n          url: `https://httpillwww.mozilla-iot.org/things/http---192.168.43.62-things-lamp1/properties/on`,\n          headers:{\n            'Content-Type': 'application/json',\n            'Accept': 'application/json',\n            'Authorization': 'Bearer eyJhbGciOiJFUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImVkYWMzMWQzLWUxMjAtNGJiMy04NWQzLTdlNTYwOGNiNjBmMyJ9.eyJjbGllbnRfaWQiOiJsb2NhbC10b2tlbiIsInJvbGUiOiJhY2Nlc3NfdG9rZW4iLCJzY29wZSI6Ii90aGluZ3M6cmVhZHdyaXRlIiwiaWF0IjoxNTM2MjA4MzI5fQ.d1f9-4LE7KJTDr6b04xAynwHdGl_TZCYhQTsurYR4dPH5KFUXLpzwrUrokODzelam8M1EmemB_AYzVNC9dHyCw'\n          },\n          onstring:'{\"on\":true}',\n          body:''\n        }\n      ],\n      on:[\n        {\n          method: 'PUT',\n          url: `https://httpillwww.mozilla-iot.org/things/http---192.168.43.62-things-lamp1/properties/on`,\n          headers:{\n            'Content-Type': 'application/json',\n            'Accept': 'application/json',\n            'Authorization': 'Bearer eyJhbGciOiJFUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImVkYWMzMWQzLWUxMjAtNGJiMy04NWQzLTdlNTYwOGNiNjBmMyJ9.eyJjbGllbnRfaWQiOiJsb2NhbC10b2tlbiIsInJvbGUiOiJhY2Nlc3NfdG9rZW4iLCJzY29wZSI6Ii90aGluZ3M6cmVhZHdyaXRlIiwiaWF0IjoxNTM2MjA4MzI5fQ.d1f9-4LE7KJTDr6b04xAynwHdGl_TZCYhQTsurYR4dPH5KFUXLpzwrUrokODzelam8M1EmemB_AYzVNC9dHyCw'\n          },\n          body:'{\"on\":true}'\n        },\n        {\n          method: 'PUT',\n          url: `https://httpillwww.mozilla-iot.org/things/http---192.168.43.62-things-lamp1/properties/level`,\n          headers:{\n            'Content-Type': 'application/json',\n            'Accept': 'application/json',\n            'Authorization': 'Bearer eyJhbGciOiJFUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImVkYWMzMWQzLWUxMjAtNGJiMy04NWQzLTdlNTYwOGNiNjBmMyJ9.eyJjbGllbnRfaWQiOiJsb2NhbC10b2tlbiIsInJvbGUiOiJhY2Nlc3NfdG9rZW4iLCJzY29wZSI6Ii90aGluZ3M6cmVhZHdyaXRlIiwiaWF0IjoxNTM2MjA4MzI5fQ.d1f9-4LE7KJTDr6b04xAynwHdGl_TZCYhQTsurYR4dPH5KFUXLpzwrUrokODzelam8M1EmemB_AYzVNC9dHyCw'\n          },\n          body:'{\"level\":65}'\n        }\n      ],\n      off:[\n        {\n          method: 'PUT',\n          url: `https://httpillwww.mozilla-iot.org/things/http---192.168.43.62-things-lamp1/properties/on`,\n          headers:{\n            'Content-Type': 'application/json',\n            'Accept': 'application/json',\n            'Authorization': 'Bearer eyJhbGciOiJFUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImVkYWMzMWQzLWUxMjAtNGJiMy04NWQzLTdlNTYwOGNiNjBmMyJ9.eyJjbGllbnRfaWQiOiJsb2NhbC10b2tlbiIsInJvbGUiOiJhY2Nlc3NfdG9rZW4iLCJzY29wZSI6Ii90aGluZ3M6cmVhZHdyaXRlIiwiaWF0IjoxNTM2MjA4MzI5fQ.d1f9-4LE7KJTDr6b04xAynwHdGl_TZCYhQTsurYR4dPH5KFUXLpzwrUrokODzelam8M1EmemB_AYzVNC9dHyCw'\n          },\n          body:'{\"on\":false}'\n        }\n      ]\n    }\n  ]\n};\n\nexport class ClockCtrl extends PanelCtrl {\n\n  constructor($scope, $injector) {\n    super($scope, $injector);\n    _.defaultsDeep(this.panel, panelDefaults);\n    //this.updateClock();\n\n    this.headtxt = \"\";\n    this.butterstate = {};\n    this.edmShowButter = -1;\n    this.edmShowButterOn = false;\n    this.edmShowButterOff = false;\n    this.edmShowButterInitial = false;\n    this.edmRequestIndex = -1;\n    //this.butter();\n\n    this.init_butterstate();\n    this.initialAllButterState();\n    this.events.on('init-edit-mode', this.onInitEditMode.bind(this));\n    //this.events.on('panel-initialized', this.render.bind(this));\n\n    this.updateButter();\n  }\n\n  onInitEditMode(){\n    this.init_edmShowButter();\n    this.addEditorTab('Options', 'public/plugins/grafana-butter-panel/editor.html', 2);\n  }\n\n  init_butterstate(){\n    var len = this.panel.butter.length;\n    for(var i;i < len;i++)\n      this.butterstate[i] = false;\n  }\n\n  init_edmShowButter(){\n    this.edmShowButter = -1;\n  }\n\n  edmToggleButter(index){\n    this.edmRequestIndex = -1;\n    this.edmShowButterOn = false;\n    this.edmShowButterOff = false;\n    if(this.edmShowButter == index)\n      this.edmShowButter = -1;\n    else\n      this.edmShowButter = index;\n    console.log(\"edmToggleButter > \"+this.edmShowButter);\n  }\n\n  edmToggleButterOn(){\n    this.edmRequestIndex = -1;\n    this.edmShowButterOn = !this.edmShowButterOn;\n    if(this.edmShowButterOn){\n      this.edmShowButterOff = false;\n      this.edmShowButterInitial = false;\n    }\n    console.log(\"edmShowButterOn > \"+this.edmShowButterOn);\n  }\n\n  edmToggleButterOff(){\n    this.edmRequestIndex = -1;\n    this.edmShowButterOff = !this.edmShowButterOff;\n    if(this.edmShowButterOff){\n      this.edmShowButterOn = false;\n      this.edmShowButterInitial = false;\n    }\n    console.log(\"edmShowButterOff > \"+this.edmShowButterOff);\n  }\n\n  edmToggleButterInitial(){\n    this.edmRequestIndex = -1;\n    this.edmShowButterInitial = !this.edmShowButterInitial;\n    if(this.edmShowButterInitial){\n      this.edmShowButterOn = false;\n      this.edmShowButterOff = false;\n    }\n    console.log(\"edmShowButterInitial > \"+this.edmShowButterInitial);\n  }\n\n  edmToggleRequest(index){\n    if(this.edmRequestIndex == index){\n      this.edmRequestIndex = -1;\n    }\n    else{\n      this.edmRequestIndex = index;\n    }\n    console.log(\"edmRequestIndex > \"+this.edmRequestIndex);\n  }\n\n  updateButter() {\n    this.tea = \"Label : \"+this.headtxt;\n    this.$timeout(() => { this.updateButter(); }, 1000);\n  }\n\n  removeButter(index) {\n    console.log(\"Remove Butter \"+index);\n    this.panel.butter.splice(index, 1);\n  }\n\n  addButter(){\n    console.log(\"Add Butter \");\n    this.panel.butter.push(\n      {\n        butterType:'on/off button',\n        label:'',\n        on:[],\n        off:[],\n        initial:[]\n      });\n  }\n\n  addRequest(bindex, mode){\n    var data = {\n      method: 'GET',\n      url: '',\n      headers:{\n        'Content-Type': 'application/json',\n        'Accept': 'application/json'\n      },\n      body:''\n    };\n\n    console.log('Add new '+mode+' request of butter'+bindex);\n\n    if(mode == 'initial'){\n      data['onstring'] = '';\n    }\n    this.panel.butter[bindex][mode].push(data);\n  }\n\n  removeRequest(bindex, mode, index){\n    console.log('Remove '+mode+' request of butter'+bindex);\n    this.panel.butter[bindex][mode].splice(index, 1);\n  }\n\n  addRequestHeader(bindex, mode, index, headerkey, headervalue){\n    console.log(\"Add request header\");\n    console.log(\"> bindex : \"+bindex);\n    console.log(\"> mode : \"+mode);\n    console.log(\"> index : \"+index);\n    console.log(\"> headerkey : \"+headerkey);\n    console.log(\"> headervalue : \"+headervalue);\n\n    if(headerkey == undefined || headerkey == '')\n      return ;\n\n    this.panel.butter[bindex][mode][index].headers[headerkey] = headervalue;\n  }\n\n  removeRequestHeader(bindex, mode, index, headerkey){\n    console.log(\"Remove request header \"+index);\n    console.log(\"> bindex : \"+bindex);\n    console.log(\"> mode : \"+mode);\n    console.log(\"> index : \"+index);\n    console.log(\"> headerkey : \"+headerkey);\n\n    delete this.panel.butter[bindex][mode][index].headers[headerkey];\n  }\n\n  initialAllButterState(){\n    var len = this.panel.butter.length;\n    console.log(\"Butter : \"+JSON.stringify(this.panel.butter));\n    for(var i = 0;i < len;i++){\n      this.initialButterState(i);\n    }\n  }\n\n  setbutterfunc(arr, len, bindex){\n    console.log(\"array : \"+JSON.stringify(arr));\n    var on = true;\n    for(var i = 0;i < len;i++){\n      console.log(\"meter : \"+this.panel.butter[bindex].initial[i].onstring);\n      console.log(\"result : \"+JSON.stringify(arr[i]));\n      if(JSON.stringify(arr[i]) != this.panel.butter[bindex].initial[i].onstring)\n        on = false;\n    }\n    this.butterstate[bindex] = on;\n  }\n\n  checkarr(arr, len, bindex){\n    console.log(\"checkarr > len : \"+arr.length);\n    if(arr.length < len)\n      this.$timeout(() => { this.checkarr(arr, len, bindex); }, 250);\n    else\n      this.setbutterfunc(arr, len, bindex);\n  }\n\n  initialButterState(bindex){\n    console.log(\"initial bindex : \"+bindex);\n    var len = this.panel.butter[bindex].initial.length;\n    var i;\n    var arr = [];\n\n    for(i = 0;i < len;i++){\n      this.sendRequest(bindex, 'initial', i)\n        .then(data => {\n          console.log(\"iReturned : \"+JSON.stringify(data));\n          arr.push(data);\n        })\n        .catch(error => console.error(error));\n    }\n\n    this.$timeout(() => { this.checkarr(arr, len, bindex); }, 250);\n    //setTimeout(function(){this.checkarr(arr, len, bindex);},250);\n  }\n\n  butter(bindex) {\n  // Default options are marked with *\n    console.log(\"Butter index : \"+bindex);\n\n    var len = 0;\n    var mode;\n    if(this.butterstate[bindex]){\n      len = this.panel.butter[bindex].on.length;\n      mode = 'on';\n    }\n    else{\n      len = this.panel.butter[bindex].off.length;\n      mode = 'off';\n    }\n\n    for(var i=0;  i < len;  i++){\n      this.sendRequest(bindex, mode, i)\n        .then(data => {\n          console.log(\"Returned : \"+JSON.stringify(data))\n          this.initialAllButterState();\n        })\n        //.catch(error => console.error(error));\n        .catch(error =>{\n          console.error(error);\n          this.butterstate[bindex] = !this.butterstate[bindex];\n        });\n    }\n  }\n\n  sendRequest(bindex, mode, cindex){\n    console.log(\"sendRequest > butterstate : \"+this.butterstate[bindex]);\n    console.log(\"sendRequest > bindex : \"+bindex);\n    console.log(\"sendRequest > mode : \"+mode);\n    console.log(\"sendRequest > cindex : \"+cindex);\n\n    //console.log(\"Make Request : \"+JSON.stringify(this.panel.butter[bindex][mode][cindex]));\n    //console.log(\"Default Request : \"+JSON.stringify(panelDefaults.butter[0][mode][0]));\n    //console.log(\"Body : \"+JSON.stringify(this.panel.butter[bindex][mode][cindex].body));\n\n    var rurl = this.panel.butter[bindex][mode][cindex].url;\n    var rmethod = this.panel.butter[bindex][mode][cindex].method;\n    var rheaders = this.panel.butter[bindex][mode][cindex].headers;\n    var rbody = this.panel.butter[bindex][mode][cindex].body;\n\n    if(this.panel.butter[bindex][mode][cindex].url == '')\n      return ;\n\n    if(rmethod == 'GET')\n      return fetch(rurl, {\n        method: rmethod, // *GET, POST, PUT, DELETE, etc.\n        headers: rheaders\n        //body: JSON.stringify(data) // body data type must match \"Content-Type\" header\n      })\n      .then(response => response.json()); // parses response to JSON\n    else\n      return fetch(rurl, {\n        method: rmethod, // *GET, POST, PUT, DELETE, etc.\n        headers: rheaders,\n        body: rbody // body data type must match \"Content-Type\" header\n        //body: JSON.stringify(data) // body data type must match \"Content-Type\" header\n      })\n      .then(response => response.json()); // parses response to JSON\n  }\n}\n\nClockCtrl.templateUrl = 'module.html';\n\n"]}